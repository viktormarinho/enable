import{S as T,i as S,s as z,a as N,b as u,c as j,d as p,n as B,e as b,f as w,g as P,h as R,l as D,t as $,j as J,k as g,m as K,o as F,p as y,q as C,r as M,I as U,u as V,v as W,B as X,w as H,x as Y,y as Z,z as ee,A as Q,C as O,D as te,E as ne,F as A,G as E}from"./index-c384d19f.js";import{P as re,c as le,N as se}from"./Portal-bbb113f2.js";import{T as ae}from"./Tag-1cb3a800.js";function oe(a){let e,n,t,r,c;return{c(){e=N("svg"),n=N("path"),t=N("path"),r=N("path"),c=N("path"),u(n,"stroke","none"),u(n,"d","M0 0h24v24H0z"),u(n,"fill","none"),u(t,"d","M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5"),u(r,"d","M16 19h6"),u(c,"d","M19 16v6"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","icon icon-tabler icon-tabler-folder-plus"),u(e,"width","24"),u(e,"height","24"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","2"),u(e,"stroke","currentColor"),u(e,"fill","none"),u(e,"stroke-linecap","round"),u(e,"stroke-linejoin","round")},m(s,o){j(s,e,o),p(e,n),p(e,t),p(e,r),p(e,c)},p:B,i:B,o:B,d(s){s&&b(e)}}}class ce extends T{constructor(e){super(),S(this,e,null,oe,z,{})}}function I(a){let e,n;return e=new re({props:{$$slots:{default:[fe]},$$scope:{ctx:a}}}),{c(){y(e.$$.fragment)},m(t,r){C(e,t,r),n=!0},p(t,r){const c={};r&271&&(c.$$scope={dirty:r,ctx:t}),e.$set(c)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){g(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function ue(a){let e,n;return e=new ae({}),{c(){y(e.$$.fragment)},m(t,r){C(e,t,r),n=!0},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){g(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function ie(a){let e,n;return e=new ce({}),{c(){y(e.$$.fragment)},m(t,r){C(e,t,r),n=!0},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){g(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function fe(a){let e,n,t,r,c,s,o,l,i,d,_;function f(m){a[6](m)}let k={type:"text",placeholder:"Project name",error:a[1].name,$$slots:{default:[ue]},$$scope:{ctx:a}};return a[0].name!==void 0&&(k.value=a[0].name),c=new U({props:k}),V.push(()=>W(c,"value",f)),l=new X({props:{loading:a[3],text:"Create",$$slots:{default:[ie]},$$scope:{ctx:a}}}),{c(){e=w("div"),n=w("form"),t=w("span"),t.textContent="New project",r=P(),y(c.$$.fragment),o=P(),y(l.$$.fragment),u(t,"class","svelte-1uyxs2l"),u(n,"class","modal-content svelte-1uyxs2l"),u(e,"class","hidden svelte-1uyxs2l"),H(e,"open",a[2])},m(m,v){j(m,e,v),p(e,n),p(n,t),p(n,r),C(c,n,null),p(n,o),C(l,n,null),i=!0,d||(_=[D(n,"submit",a[5]),Y(le.call(null,e)),D(e,"click_outside",a[7])],d=!0)},p(m,v){const h={};v&2&&(h.error=m[1].name),v&256&&(h.$$scope={dirty:v,ctx:m}),!s&&v&1&&(s=!0,h.value=m[0].name,Z(()=>s=!1)),c.$set(h);const q={};v&8&&(q.loading=m[3]),v&256&&(q.$$scope={dirty:v,ctx:m}),l.$set(q),(!i||v&4)&&H(e,"open",m[2])},i(m){i||($(c.$$.fragment,m),$(l.$$.fragment,m),i=!0)},o(m){g(c.$$.fragment,m),g(l.$$.fragment,m),i=!1},d(m){m&&b(e),M(c),M(l),d=!1,ee(_)}}}function pe(a){let e,n,t,r,c,s,o=a[2]&&I(a);return{c(){e=w("button"),e.innerHTML="<span>Create project +</span>",n=P(),o&&o.c(),t=R(),u(e,"class","btn-secondary")},m(l,i){j(l,e,i),j(l,n,i),o&&o.m(l,i),j(l,t,i),r=!0,c||(s=D(e,"click",a[4]),c=!0)},p(l,[i]){l[2]?o?(o.p(l,i),i&4&&$(o,1)):(o=I(l),o.c(),$(o,1),o.m(t.parentNode,t)):o&&(J(),g(o,1,1,()=>{o=null}),K())},i(l){r||($(o),r=!0)},o(l){g(o),r=!1},d(l){l&&(b(e),b(n),b(t)),o&&o.d(l),c=!1,s()}}}function me(a,e,n){let t={name:""},r=F.make(t),c=!1,s=!1;async function o(){n(2,c=!0)}async function l(_){_.preventDefault(),n(3,s=!0);const f=await fetch("/api/projects",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});if(!f.ok){n(1,r=F.apply(r,await f.json())),n(3,s=!1);return}const{project:k}=await f.json();Q(`#/admin/project/${k.id}`),n(3,s=!1)}function i(_){a.$$.not_equal(t.name,_)&&(t.name=_,n(0,t))}return[t,r,c,s,o,l,i,()=>n(2,c=!1)]}class de extends T{constructor(e){super(),S(this,e,me,pe,z,{})}}function _e(a){let e,n,t;return{c(){e=N("svg"),n=N("path"),t=N("path"),u(n,"stroke","none"),u(n,"d","M0 0h24v24H0z"),u(n,"fill","none"),u(t,"d","M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","icon icon-tabler icon-tabler-folder"),u(e,"width","24"),u(e,"height","24"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","2"),u(e,"stroke","currentColor"),u(e,"fill","none"),u(e,"stroke-linecap","round"),u(e,"stroke-linejoin","round")},m(r,c){j(r,e,c),p(e,n),p(e,t)},p:B,i:B,o:B,d(r){r&&b(e)}}}class $e extends T{constructor(e){super(),S(this,e,null,_e,z,{})}}function L(a,e,n){const t=a.slice();return t[2]=e[n],t}function x(a){let e,n,t,r,c=a[2].name+"",s,o,l,i=G(a[2].feature_count)+"",d,_,f,k,m;t=new $e({});function v(){return a[1](a[2])}return{c(){e=w("button"),n=w("span"),y(t.$$.fragment),r=P(),s=A(c),o=P(),l=w("span"),d=A(i),_=P(),u(n,"class","svelte-e33twq"),u(l,"class","svelte-e33twq"),u(e,"class","project svelte-e33twq")},m(h,q){j(h,e,q),p(e,n),C(t,n,null),p(n,r),p(n,s),p(e,o),p(e,l),p(l,d),p(e,_),f=!0,k||(m=D(e,"click",v),k=!0)},p(h,q){a=h,(!f||q&1)&&c!==(c=a[2].name+"")&&E(s,c),(!f||q&1)&&i!==(i=G(a[2].feature_count)+"")&&E(d,i)},i(h){f||($(t.$$.fragment,h),f=!0)},o(h){g(t.$$.fragment,h),f=!1},d(h){h&&b(e),M(t),k=!1,m()}}}function he(a){let e,n,t=O(a[0]),r=[];for(let s=0;s<t.length;s+=1)r[s]=x(L(a,t,s));const c=s=>g(r[s],1,1,()=>{r[s]=null});return{c(){e=w("div");for(let s=0;s<r.length;s+=1)r[s].c();u(e,"class","projects svelte-e33twq")},m(s,o){j(s,e,o);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null);n=!0},p(s,[o]){if(o&1){t=O(s[0]);let l;for(l=0;l<t.length;l+=1){const i=L(s,t,l);r[l]?(r[l].p(i,o),$(r[l],1)):(r[l]=x(i),r[l].c(),$(r[l],1),r[l].m(e,null))}for(J(),l=t.length;l<r.length;l+=1)c(l);K()}},i(s){if(!n){for(let o=0;o<t.length;o+=1)$(r[o]);n=!0}},o(s){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)g(r[o]);n=!1},d(s){s&&b(e),te(r,s)}}}function G(a){return a===1?"1 feature":a===0?"no features":`${a} features`}function ge(a,e,n){let t=[];return ne(async()=>{const c=await fetch("/api/projects"),{projects:s}=await c.json();n(0,t=s)}),[t,c=>Q(`#/admin/project/${c.id}`)]}class ve extends T{constructor(e){super(),S(this,e,ge,he,z,{})}}function we(a){let e,n,t,r,c,s,o,l,i,d,_;return n=new se({}),l=new de({}),d=new ve({}),{c(){e=w("div"),y(n.$$.fragment),t=P(),r=w("div"),c=w("header"),s=w("h1"),s.textContent="Projects",o=P(),y(l.$$.fragment),i=P(),y(d.$$.fragment),u(c,"class","page-header"),u(r,"class","page")},m(f,k){j(f,e,k),C(n,e,null),p(e,t),p(e,r),p(r,c),p(c,s),p(c,o),C(l,c,null),p(r,i),C(d,r,null),_=!0},p:B,i(f){_||($(n.$$.fragment,f),$(l.$$.fragment,f),$(d.$$.fragment,f),_=!0)},o(f){g(n.$$.fragment,f),g(l.$$.fragment,f),g(d.$$.fragment,f),_=!1},d(f){f&&b(e),M(n),M(l),M(d)}}}class Pe extends T{constructor(e){super(),S(this,e,null,we,z,{})}}export{Pe as default};
